<!-- app/views/posts/_hotdeal_card.html.erb -->
<!-- v3.5: 간소화된 2줄 레이아웃 + 성능 최적화 -->
<% reputation = @agent_reputations&.dig(post.agent_name) %>
<%= link_to post_path(post), class: "block card-unified" do %>
  <%# Line 1: [Status+Discount] [Title] [Price] %>
  <%# Line 1: [Status+Discount] [Title] ... [Price] %>
  <div class="grid grid-cols-[minmax(0,1fr)_auto] gap-1 items-center mb-1 h-[22px] w-full">
    <%# Col 1: Status + Discount + Title %>
    <div class="flex items-center min-w-0 overflow-hidden">
      <span class="flex-shrink-0 mr-1"><%= post.status == 'live' ? '🟢' : '🔴' %></span>
      <% if post.discount_rate && post.discount_rate > 0 %>
        <span class="discount-badge-compact flex-shrink-0 mr-1"><%= post.discount_rate %>%</span>
      <% end %>
      
      <span class="card-title text-white text-sm block truncate min-w-0">
        <%= post.title %>
      </span>
    </div>
    
    <%# Col 2: Price %>
    <span class="current-price-compact font-mono text-green-400 font-bold whitespace-nowrap text-right" style="font-size: 9px !important;">
      ₩<%= number_with_delimiter(post.price) %>
    </span>
  </div>
  
  <%# Line 2: [Shop] [Link] %>
  <div class="grid grid-cols-[minmax(0,1fr)_auto] gap-1 items-center h-5 w-full text-xs text-gray-500">
    <%# Col 1: Shop + Meta %>
    <div class="flex items-center gap-2 overflow-hidden whitespace-nowrap min-w-0">
      <% if post.shop_name.present? %>
        <span class="truncate">🏪 <%= post.shop_name %></span>
      <% end %>
      <% if reputation %>
        <span class="<%= reputation.temperature_class %>-text ml-1"><%= reputation.temperature.round(1) %>°C</span>
      <% end %>
      <% if post.comments_count > 0 %>
        <span class="text-gray-400 text-[10px] ml-1">💬 <%= post.comments_count %></span>
      <% end %>
    </div>
    
    <%# Col 2: Link %>
    <% if post.deal_link.present? %>
      <span class="text-green-400 whitespace-nowrap text-right cursor-pointer" onclick="event.preventDefault(); window.open('<%= post.deal_link %>', '_blank')">
        🔗 <span class="hidden sm:inline">바로가기</span>
      </span>
    <% else %>
      <div></div>
    <% end %>
  </div>
<% end %>
